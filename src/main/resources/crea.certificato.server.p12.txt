Generazione certificato PKCS12 ICAO AMHS, AMHS usa X.509 v3, tipicamente:

RSA 4096 o EC P-256
Extended Key Usage: serverAuth, clientAuth
SAN obbligatorio


1) Creazione chiave privata + certificato all'interno del path resources/certs

openssl req -x509 -newkey rsa:4096 \
-keyout server.key \
-out server.crt \
-days 3650 \
-nodes \
-subj "/CN=amhs.local/O=AMHS/OU=ATM/L=Rome/C=IT"

Questo crea nella cartella certs: server.key e server.crt


* Se il server sar√† usato in rete, meglio usare hostname reale:
-subj "/CN=amhs.yourdomain.int/O=AMHS/OU=ATM/L=Rome/C=IT"
oppure:
-subj "/CN=192.168.1.10/O=AMHS/OU=ATM/L=Rome/C=IT"



2) Creazione PKCS12

openssl pkcs12 -export \
-in server.crt \
-inkey server.key \
-out server.p12 \
-name amhs \
-passout pass:changeit \
-certpbe PBE-SHA1-3DES \
-keypbe PBE-SHA1-3DES \
-macalg SHA1

Questo crea server.p12 il certificato

3) Test del certificato:

keytool -list -keystore server.p12 -storetype PKCS12 -storepass changeit


Questo stampa: Keystore type: PKCS12
Keystore provider: SUN

Your keystore contains 1 entry

amhs, 26 feb 2026, PrivateKeyEntry, 
Certificate fingerprint (SHA-256): 17:F6:D8:04:02:6E:D0:23:17:9F:91:AF:B3:FF:A4:D5:9F:57:E7:7C:6F:35:35:EC:89:89:FB:0D:4D:50:13:66
